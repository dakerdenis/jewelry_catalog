{% extends 'base.html' %}
{% load static %}

{% block title %}
  Landing — Jewelry Shop
{% endblock %}

{% block body_class %}
  page-landing
{% endblock %}

{% block extra_css %}
  <link href="{% static 'css/pages/landing.css' %}" rel="stylesheet" />
{% endblock %}

{% block content %}
  {# # lANDING PAGE WRAPPER #}
  <div class="landing__wrapper">
    {# LANDING MAIN SCREEEN #}
    <div class="landing__main">
      <div class="landing__main-back">
        <img src="{% static 'img/landing/main-back.jpg' %}" alt="OUSVOW JEWELRY RING" />
      </div>

      <div class="landing__main-text">
        <h2>OUSVOW JEWELRY</h2>
        <p>Is a high-end jewelry brand founded by jewelry designer RICHH OU，was established in 2016.</p>
        <p>The brand uses 18k gold as its main material and incorporates various natural diamonds and colored gemstones.</p>
      </div>
    </div>

    {# LANDING ANIMATIONS #}
    {# LANDING ANIMATIONS #}
    <div class="landing__animation" aria-hidden="true">
      <div class="landing__animation-track">
        <div class="landing__animation-set">
          <img src="{% static 'img/landing/OUSVOW.svg' %}" alt="" />
          <img src="{% static 'img/landing/OUSVOW.svg' %}" alt="" />
          <img src="{% static 'img/landing/OUSVOW.svg' %}" alt="" />
          <img src="{% static 'img/landing/OUSVOW.svg' %}" alt="" />
        </div>
        <!-- вторую партию НЕ меняем (должна быть 1-в-1) -->
        <div class="landing__animation-set">
          <img src="{% static 'img/landing/OUSVOW.svg' %}" alt="" />
          <img src="{% static 'img/landing/OUSVOW.svg' %}" alt="" />
          <img src="{% static 'img/landing/OUSVOW.svg' %}" alt="" />
          <img src="{% static 'img/landing/OUSVOW.svg' %}" alt="" />
        </div>
      </div>
    </div>

    {# LANDING OUR STORY #}
    <div class="landing__story">
      <div class="story__wrapper">
        <div class="story__image">
          <img src="{% static 'img/landing/ring.png' %}" alt="" />
        </div>
        <div class="story__content">
          <h2>Our Story</h2>
          <p>Each piece of OUSVOW JEWELRY is a unique and cutting-edge original design, meticulously handcraed with exceptional quality, exquisite crasmanship, avant-garde aesthetics, and attention to detail.</p>
          <p>OUSVOW aims to provide its customers with a new visual</p>
          <p>feast and brand experience, Its unique "parallel four-dimensional aesthetic system" and "cutting-edge jewelry design style" subvert everyone's understanding of jewelry, combining playfulness and artistry.</p>
        </div>
      </div>
    </div>

    {# LANDING COLLECTIONS #}
    <div class="landing__collections">
      <div class="collections__wrapper">
        <div class="collections__text">
          <h2>Jewelry product lines tells eternal stories</h2>
          <div class="collections__text-container">
            <p>Test Collection</p>
            <p>City</p>
            <p>Jade</p>
            <p>Future</p>
          </div>
        </div>

        <div class="collections__image">
          <img src="{% static 'img/landing/ring2.png' %}" alt="" />
        </div>
      </div>
    </div>

    {# LANDING GOODS #}
    {# LANDING GOODS #}
    <div class="landing__goods">
      <div class="goods__wrapper">
        {% if landing_goods %}
          {% for p in landing_goods %}
            {% with img=p.images.all|first %}
              {# Чередуем раскладку: для 1-го — картинка слева, для 2-го — справа #}
              {% if forloop.counter|divisibleby:2 %}
                <div class="goods__element">
                  <div class="goods__element-desc">
                    <div class="goods__element-name">{{ p.name }}</div>
                    <div class="goods__element-text">{{ p.description|default:'' }}</div>
                    <div class="goods__element-price">
                      <span>{{ p.price }}</span> $
                    </div>
                  </div>
                  <div class="goods__element-image">
                    <a href="{{ p.get_absolute_url }}">
                      {% if img %}
                        <img src="{{ img.image.url }}" alt="{{ p.name }}" />
                      {% else %}
                        <img src="{% static 'img/placeholder.png' %}" alt="{{ p.name }}" />
                      {% endif %}
                    </a>
                  </div>
                </div>
              {% else %}
                <div class="goods__element">
                  <div class="goods__element-image">
                    <a href="{{ p.get_absolute_url }}">
                      {% if img %}
                        <img src="{{ img.image.url }}" alt="{{ p.name }}" />
                      {% else %}
                        <img src="{% static 'img/placeholder.png' %}" alt="{{ p.name }}" />
                      {% endif %}
                    </a>
                  </div>
                  <div class="goods__element-desc">
                    <div class="goods__element-name">{{ p.name }}</div>
                    <div class="goods__element-text">{{ p.description|default:'' }}</div>
                    <div class="goods__element-price">
                      <span>{{ p.price }}</span> $
                    </div>
                  </div>
                </div>
              {% endif %}
            {% endwith %}
          {% endfor %}
        {% endif %}
      </div>
    </div>

    {# LANDING CONCEPT #}
    <div class="landind__concept">
      <div class="concept__wrapper">
        <div class="concept__image">
          <img src="{% static 'img/landing/ou.png' %}" alt="" />
        </div>

        <div class="concept__desc">
          <p>Brand’s design concept</p>
          <h2>RICHH OU</h2>
          <div>Designer RICHH OU spent over four months creating a milestone jewelry piece, a solid 18k gold and platinum pendant and necklace set representing his exclusive portrait in the parallel four-dimensional space called CITY. This groundbreaking jewelry piece follows the brand's innovative and avant-garde design style, challenging traditional perceptions of jewelry and establishing a benchmark for the "Parallel Four-Dimensional Aesthetic" system...</div>
          <button>Read More</button>
        </div>
      </div>
    </div>

    {# LANDING GOLD #}
    <div class="landing__gold">
      <div class="gold__wrapper">
        <div class="gold__text">
          <h2>100% Gold</h2>
          <p>Lorem ipsum dolor sit amet consectetur. Dolor et volutpat in non. Luctus sit libero urna viverra sed non dui elementum Dolor et volutpat in non. Luctus sit libero urna viverra .</p>
        </div>
        <div class="gold__image">
          <img src="{% static 'img/landing/gold.jpg' %}" alt="" />
        </div>
      </div>
    </div>



    <section class="hero-video">
      <div class="hero-video__bg">
        <!-- img src="{% static 'img/landing/hero.jpg' %}" alt="" / -->
      </div>

      <button class="hero-video__play" id="openVideo" aria-label="Play video" data-yturl="https://youtube.com/shorts/zpHBbHwFHDM?si=0cEXtULe4k5jUnvT">
        <img src="{% static 'img/landing/button-video.svg' %}" alt="" srcset="">
        
      </button>

      <div class="hero-video__text">
        <h2>Lorem Ipsum</h2>
        <p>The definitive selection to celebrate in style</p>
      </div>
    </section>

    <!-- Modal -->
    <div class="video-modal" id="videoModal" hidden>
      <div class="video-modal__overlay" data-close></div>
      <div class="video-modal__dialog" role="dialog" aria-modal="true" aria-label="Video">
        <button class="video-modal__close" data-close aria-label="Close">×</button>
        <div class="video-modal__player" id="videoPlayer"></div>
      </div>
    </div>

    {# LANDING 3 Goods #}
    {% if landing_three %}
      <div class="landing__3element">
        <div class="elements__wrapper">
          {% for p in landing_three %}
            <div class="elements-element">
              <div class="elements-img">
                {% with img=p.images.all|first %}
                  <a href="{{ p.get_absolute_url }}">
                    {% if img %}
                      <img src="{{ img.image.url }}" alt="{{ p.name }}" />
                    {% else %}
                      <img src="{% static 'img/placeholder.png' %}" alt="{{ p.name }}" />
                    {% endif %}
                  </a>
                {% endwith %}
              </div>
              <div class="elements-desc">
                <div class="elements-name">{{ p.name }}</div>
                <div class="elements-price">{{ p.price }} $</div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}

    {# LANDING SIGN UP #}
    <div class="langind__sing">
      <div class="sing__wrapper">
        <div class="sing__desc">
          <h2>Get the Latest From Ousvow</h2>
          <p>Be the first to hear about new arrivals, promotions, style inspiration and exclusive sneak peeks.</p>
        </div>
        <div class="sing__field">
          <form action="#">
            <input placeholder="Enter email address" type="text" />
            <button>SING UP</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const track = document.querySelector('.landing__animation-track')
      if (track && track.children.length === 1) {
        track.appendChild(track.firstElementChild.cloneNode(true))
      }
    })
  </script>

  <script>
    ;(function () {
      const btn = document.getElementById('openVideo')
      const modal = document.getElementById('videoModal')
      const slot = document.getElementById('videoPlayer')
    
      if (!btn || !modal || !slot) return
    
      // Универсально выдергиваем ID из watch/shorts/youtu.be
      function getYouTubeId(url) {
        try {
          const u = new URL(url)
          if (u.hostname.includes('youtu.be')) return u.pathname.slice(1)
          if (u.pathname.startsWith('/shorts/')) return u.pathname.split('/shorts/')[1].split('/')[0]
          if (u.searchParams.get('v')) return u.searchParams.get('v')
          const m = url.match(/(?:embed|shorts|watch\/|v\/)([A-Za-z0-9_-]{11})/)
          return m ? m[1] : null
        } catch {
          return null
        }
      }
    
      function buildSrc(id) {
        const p = new URLSearchParams({
          autoplay: 1,
          playsinline: 1,
          modestbranding: 1,
          rel: 0
          // Чтобы точно зациклилось (если нужно): loop=1&playlist=<ID>
          // loop: 1, playlist: id
        })
        return `https://www.youtube-nocookie.com/embed/${id}?${p.toString()}`
      }
    
      function openModal() {
        const id = getYouTubeId(btn.dataset.yturl || '')
        if (!id) return
    
        const iframe = document.createElement('iframe')
        iframe.src = buildSrc(id)
        iframe.title = 'YouTube video'
        iframe.allow = 'autoplay; encrypted-media; picture-in-picture'
        iframe.allowFullscreen = true
        iframe.style.width = '100%'
        iframe.style.height = '100%'
        slot.innerHTML = ''
        slot.appendChild(iframe)
    
        modal.hidden = false
        document.body.style.overflow = 'hidden'
      }
    
      function closeModal() {
        modal.hidden = true
        slot.innerHTML = '' // удаляем iframe, чтобы остановить воспроизведение
        document.body.style.overflow = ''
      }
    
      btn.addEventListener('click', openModal)
      modal.addEventListener('click', (e) => {
        if (e.target.hasAttribute('data-close')) closeModal()
      })
      window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && !modal.hidden) closeModal()
      })
    })()
  </script>
{% endblock %}
